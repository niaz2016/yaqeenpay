# ================================================================
# DNS RECORDS FOR CLOUDFLARE - techtorio.online
# ================================================================
# IMPORTANT: Make sure to turn OFF the orange cloud (proxy) for the 'mail' A record
# Email ports (25, 587, 993) cannot go through Cloudflare proxy
# ================================================================

# -------------------
# 1. A RECORD FOR MAIL SERVER
# -------------------
Type: A
Name: mail
IPv4 Address: YOUR_PUBLIC_IP_ADDRESS
TTL: Auto
Proxy Status: DNS only (TURN OFF ORANGE CLOUD!)

# HOW TO GET YOUR PUBLIC IP:
# Visit: https://whatismyipaddress.com/
# Or run in PowerShell: (Invoke-WebRequest -Uri "https://api.ipify.org").Content

# -------------------
# 2. MX RECORD (Mail Exchanger)
# -------------------
Type: MX  
Name: @
Mail Server: mail.techtorio.online
Priority: 10
TTL: Auto

# -------------------
# 3. SPF RECORD (Sender Policy Framework - Anti-spam)
# -------------------
Type: TXT
Name: @
Content: v=spf1 mx a:mail.techtorio.online ~all
TTL: Auto

# Explanation:
# - v=spf1: SPF version 1
# - mx: Allow MX servers to send mail
# - a:mail.techtorio.online: Allow the A record of mail.techtorio.online
# - ~all: Softfail for all others (mark as spam but don't reject)

# -------------------
# 4. DKIM RECORD (DomainKeys Identified Mail - Email Authentication)
# -------------------
Type: TXT
Name: mail._domainkey
Content: v=DKIM1; h=sha256; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtwO0kGjUq3zAasFCV5tIXRyWRyceMH/9TY3KkLbE3iryvaVeGRj79oLm7GSB4TWWGVQWVOjK0Ur21mKraTlVKKHZxGnjl2KDa08GwsZNmMp3IUmlgq7lZ1teT19fed4DsltOgNJdaGsysVZ5YN4YQchFfBvLERViL+psEQxqVNIc3NvaE2rr/jHsObCmeMW/KIq0glJUYcMZqhjV7outqQSv4SVjImBbd7E7Yo8+5/6HaYoHQX5cT3x/sl23XeQRzLxNtg90L3hbz6EaYIUFkJTHI+GmzG4b4ndB+oFhr0rCUK96YDtXDCzJBx0AdLbsGLw7RYYGlY31XmoA+nfWaQIDAQAB
TTL: Auto

# NOTE: This is a single line - remove any line breaks when pasting into Cloudflare
# Some DNS providers might have a character limit - use the short version if needed

# -------------------
# 5. DMARC RECORD (Domain-based Message Authentication, Reporting & Conformance)
# -------------------
Type: TXT
Name: _dmarc
Content: v=DMARC1; p=quarantine; rua=mailto:admin@techtorio.online; ruf=mailto:admin@techtorio.online; fo=1; pct=100
TTL: Auto

# Explanation:
# - v=DMARC1: DMARC version 1
# - p=quarantine: Quarantine emails that fail DMARC (put in spam folder)
# - rua: Aggregate reports sent to admin@techtorio.online
# - ruf: Forensic reports sent to admin@techtorio.online
# - fo=1: Generate reports for all failures
# - pct=100: Apply policy to 100% of messages

# -------------------
# 6. OPTIONAL: SUBDOMAIN WILDCARD (for user subdomains)
# -------------------
Type: A
Name: *
IPv4 Address: YOUR_PUBLIC_IP_ADDRESS
TTL: Auto
Proxy Status: Proxied (ORANGE CLOUD ON for web traffic)

# This allows *.techtorio.online to work for user subdomains

# ================================================================
# VERIFICATION COMMANDS (Run after adding DNS records)
# ================================================================

# Check MX record:
nslookup -type=MX techtorio.online

# Check SPF record:
nslookup -type=TXT techtorio.online

# Check DKIM record:
nslookup -type=TXT mail._domainkey.techtorio.online

# Check DMARC record:
nslookup -type=TXT _dmarc.techtorio.online

# Check A record for mail server:
nslookup mail.techtorio.online

# ================================================================
# PORT FORWARDING (If using local computer behind router)
# ================================================================

# You need to forward these ports from your router to your computer's LOCAL IP:
# - Port 25 (SMTP - incoming mail)
# - Port 587 (Submission - authenticated sending)
# - Port 465 (SMTPS - SSL/TLS)
# - Port 993 (IMAPS - secure IMAP)
# - Port 143 (IMAP - optional)
# - Port 995 (POP3S - optional)
# - Port 110 (POP3 - optional)

# Steps:
# 1. Find your computer's local IP: ipconfig
# 2. Log into your router (usually 192.168.1.1 or 192.168.0.1)
# 3. Go to Port Forwarding section
# 4. Forward ports above to your local IP
# 5. Make sure Windows Firewall allows these ports

# ================================================================
# IMPORTANT NOTES
# ================================================================

# 1. CLOUDFLARE TUNNEL LIMITATION:
#    - Cloudflare Tunnel does NOT support SMTP/IMAP protocols
#    - You MUST expose mail ports directly (port forwarding or VPS)
#    - The 'mail' A record MUST point to your actual public IP (not tunneled)

# 2. ISP PORT 25 BLOCKING:
#    - Many residential ISPs block port 25 outbound
#    - This prevents you from receiving emails from other servers
#    - Solutions:
#      a) Contact ISP to unblock port 25 (usually for business plans)
#      b) Use a VPS ($5/month from Vultr, Hetzner, DigitalOcean)
#      c) Use SMTP relay for sending (port 587 usually works)

# 3. REVERSE DNS (PTR):
#    - Residential IPs usually can't set reverse DNS
#    - Many email servers reject emails without proper PTR records
#    - VPS providers allow you to set reverse DNS

# 4. EMAIL DELIVERABILITY:
#    - Test your mail server: https://www.mail-tester.com/
#    - Check blacklists: https://mxtoolbox.com/blacklists.aspx
#    - Monitor reputation: https://postmaster.google.com/

# 5. DNS PROPAGATION:
#    - DNS changes can take 1-48 hours to propagate globally
#    - Use https://dnschecker.org/ to check propagation status

